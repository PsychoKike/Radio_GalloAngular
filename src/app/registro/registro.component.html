<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-8 col-xl-7">

      <div class="card shadow-lg border-0 rounded-4 overflow-hidden">

        <!-- ENCABEZADO -->
        <div class="bg-primary text-white text-center p-4">
          <h3 class="fw-bold mb-1">
            @if (esOyente) {
              Registro de Oyente üéß
            } @else {
              Registro de Locutor üéôÔ∏è
            }
          </h3>
          <small class="opacity-75">Completa todos los datos requeridos</small>
        </div>

        <!-- CUERPO -->
        <div class="card-body p-4">

          <form class="row g-4 needs-validation"
                (ngSubmit)="onSubmit(miForm)"
                #miForm="ngForm"
                [class.was-validated]="miForm.submitted"
                novalidate>

            <!-- INFORMACI√ìN PERSONAL -->
            <h5 class="fw-semibold text-secondary pb-2 border-bottom">Informaci√≥n Personal</h5>

            <div class="col-md-6">
              <label class="form-label fw-semibold">Nombre Completo</label>
              <input type="text" class="form-control rounded-3" name="nombre" [(ngModel)]="usuario.nombre" required>
              <div class="invalid-feedback">El nombre es obligatorio.</div>
            </div>

            <div class="col-md-6">
              <label class="form-label fw-semibold">Nombre de Usuario (Login)</label>
              <input type="text" class="form-control rounded-3" name="username" [(ngModel)]="usuario.username" required>
              <div class="invalid-feedback">Campo obligatorio.</div>
            </div>

            <div class="col-md-6">
              <label class="form-label fw-semibold">Tel√©fono</label>
              <input type="tel" class="form-control rounded-3" name="telefono" [(ngModel)]="usuario.telefono" required>
              <div class="invalid-feedback">Tel√©fono requerido.</div>
            </div>

            <!-- CORREO ELECTR√ìNICO -->
            <div class="col-md-12">
              <label class="form-label fw-semibold">Correo Electr√≥nico</label>

              <div class="input-group">
                <input
              #emailInput
              type="email"
              class="form-control"
              name="email"
              [(ngModel)]="usuario.email"
              (input)="onEmailChange(emailInput.value)"
              required
            >

              </div>

              <div class="invalid-feedback">Correo requerido.</div>

              <!-- Mostrar mensaje din√°mico -->
              <div *ngIf="correoStatus !== null" class="mt-1">
                <small 
                  [ngClass]="{
                    'text-success': correoStatus === 'valid',
                    'text-danger': correoStatus === 'invalid'
                  }"
                >
                  {{ correoMensaje }}
                </small>
              </div>
            </div>

            <div class="col-md-6">
              <label class="form-label fw-semibold">Contrase√±a</label>
              <input type="password" class="form-control rounded-3" name="password" [(ngModel)]="usuario.password" required minlength="6">
              <div class="invalid-feedback">M√≠nimo 6 caracteres.</div>
            </div>

            <div class="col-md-6">
              <label class="form-label fw-semibold">Confirmar Contrase√±a</label>
              <input type="password" class="form-control rounded-3" name="confirmPassword" ngModel required>
              <div class="invalid-feedback">Confirma tu contrase√±a.</div>
            </div>

            <!-- DOMICILIO -->
            <h5 class="fw-semibold text-secondary pb-2 border-bottom mt-2">Domicilio</h5>

            <div class="col-md-6">
              <label class="form-label fw-semibold">Calle y N√∫mero</label>
              <input type="text" class="form-control rounded-3" name="calle" [(ngModel)]="usuario.direccion.calle" required>
              <div class="invalid-feedback">Campo obligatorio.</div>
            </div>

            <div class="col-md-6">
              <label class="form-label fw-semibold">Colonia</label>
              <input type="text" class="form-control rounded-3" name="colonia" [(ngModel)]="usuario.direccion.colonia" required>
              <div class="invalid-feedback">Campo obligatorio.</div>
            </div>

            <div class="col-md-5">
              <label class="form-label fw-semibold">Ciudad</label>
              <input type="text" class="form-control rounded-3" name="ciudad" [(ngModel)]="usuario.direccion.ciudad" required>
              <div class="invalid-feedback">Campo obligatorio.</div>
            </div>

            <div class="col-md-4">
              <label class="form-label fw-semibold">Estado</label>
              <select class="form-select rounded-3" name="estado" [(ngModel)]="usuario.direccion.estado" required>
                <option disabled selected value="">Elegir...</option>
                <option value="AGS">Aguascalientes</option>
                <option value="CDMX">Ciudad de M√©xico</option>
                <option value="JAL">Jalisco</option>
                <option value="NL">Nuevo Le√≥n</option>
              </select>
              <div class="invalid-feedback">Selecciona un estado.</div>
            </div>

            <div class="col-md-3">
              <label class="form-label fw-semibold">C.P.</label>
              <input type="text" class="form-control rounded-3" name="cp" [(ngModel)]="usuario.direccion.codigoPostal" required>
              <div class="invalid-feedback">Campo obligatorio.</div>
            </div>

            <!-- BOTONES -->
            <div class="d-flex gap-3 mt-4">
              <button type="button" class="btn btn-light border btn-lg w-50 rounded-3 shadow-sm"
                      (click)="cancelar()">
                Cancelar
              </button>

              <button type="submit" class="btn btn-primary btn-lg w-50 rounded-3 shadow-sm">
                @if (esOyente) {
                  Registrar Oyente
                } @else {
                  Guardar Locutor
                }
              </button>
            </div>

          </form>

        </div>
      </div>

    </div>
  </div>
</div>
